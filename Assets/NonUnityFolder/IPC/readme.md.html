**Inter Process Communication**

IPC is achieved by using memory mapped files which can be thought of as shared memory.

~~~~~~
	Hashtable sharedMemoryLayout = new Hashtable();
    void Start ()
    {
		int locationCounter = 0;

        locationCounter = AddSection("unityFlag", 1, locationCounter, sharedMemoryLayout);
        locationCounter = AddSection("pythonFlag", 1, locationCounter, sharedMemoryLayout);
				.
				.
				.
        locationCounter = AddSection("carData", car.carControlsData.Length, locationCounter, sharedMemoryLayout);
        locationCounter = AddSection("pythonData", car.pythonData.Length, locationCounter, sharedMemoryLayout);
				.
				.
				.
		string layoutCSV = GenerateCSV(sharedMemoryLayout);
        File.WriteAllText("W:\\BeProject\\VirtualModelTester\\Assets\\NonUnityFolder\\Data\\sharedMemoryLayout.csv", layoutCSV);
				.
				.
				.
    }
~~~~~~

The Start() method in IPCController.cs defines the data that would be present in the shared memory.
**AddSection** takes a section name, the size in bytes of that section, current locationCounter within the shared memory, and the layout hastable.
Change **Start()** method and use **AddSection** if you want to add some more sections to exchange between python and unity.

**layoutCSV** is generated and later stored at the Data folder so that the python IPCController can read the layout and know which section lies where in the memory.
~~~~~~

// Example of the layout csv

Section Name, Start Byte, Size
unityFlag,0,1
Front,393224,196608
Right,8,196608
carData,2,4
Left,196616,196608
pythonData,6,2
pythonFlag,1,1
~~~~~~

The **Update()** method in the IPCController.cs writes the Unity produced data in the shared memory and reads the data written by python.
Change **Update()** method if you want to write some data to the shared memory.

IPCController.py is similar to **Update()** method of IPCController.cs.

If you do not want sync between python and unity, comment out UNITY_IPC_SYNC and PYTHON_IPC_SYNC in IPCController.cs; set UNITY_IPC_SYNC = 0 in IPCController.py

Set IPCController.on = false if you want to be in training mode.
Set IPCController.on = true if you want to be in testing mode.

First start Unity Game, then start IPCController.py because python needs the layout csv generated by Unity.


<!-- Markdeep: --><style class="fallback">body{visibility:hidden;white-space:pre;font-family:monospace}</style><script src="markdeep.min.js"></script><script src="https://casual-effects.com/markdeep/latest/markdeep.min.js?"></script><script>window.alreadyProcessedMarkdeep||(document.body.style.visibility="visible")</script>
